description = "Upload CV layout"

[staticMenu mainMenu]
code = "main-menu"

[staticPage]

[localePicker]
forceUrl = 1

[langCheck]

[form]

[googleTracker]
==

{variable name="cvTitle" label="Section title" tab="Side" type="text"}{/variable}
{variable name="cvSubTitle" label="Section sub title" tab="Side" type="text"}{/variable}

<!DOCTYPE html>
<html lang="{{ activeLocale }}">
    <head>
        <meta charset="utf-8">
        <title>{{ this.page.title }} | Search It Recruitment</title>
        <meta name="description" content="{{ this.page.meta_description }}">
        <meta name="title" content="{{ this.page.meta_title }}">
        <meta name="author" content="Search It Recruitment">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="generator" content="Search It Recruitment">
        <link rel="apple-touch-icon" sizes="57x57" href="{{ 'assets/img/favicon/apple-icon-57x57.png'|theme }}">
        <link rel="apple-touch-icon" sizes="60x60" href="{{ 'assets/img/favicon/apple-icon-60x60.png'|theme }}">
        <link rel="apple-touch-icon" sizes="72x72" href="{{ 'assets/img/favicon/apple-icon-72x72.png'|theme }}">
        <link rel="apple-touch-icon" sizes="76x76" href="{{ 'assets/img/favicon/apple-icon-76x76.png'|theme }}">
        <link rel="apple-touch-icon" sizes="114x114" href="{{ 'assets/img/favicon/apple-icon-114x114.png'|theme }}">
        <link rel="apple-touch-icon" sizes="120x120" href="{{ 'assets/img/favicon/apple-icon-120x120.png'|theme }}">
        <link rel="apple-touch-icon" sizes="144x144" href="{{ 'assets/img/favicon/apple-icon-144x144.png'|theme }}">
        <link rel="apple-touch-icon" sizes="152x152" href="{{ 'assets/img/favicon/apple-icon-152x152.png'|theme }}">
        <link rel="apple-touch-icon" sizes="180x180" href="{{ 'assets/img/favicon/apple-icon-180x180.png'|theme }}">
        <link rel="icon" type="image/png" sizes="192x192"  href="{{ 'assets/img/favicon/android-icon-192x192.png'|theme }}">
        <link rel="icon" type="image/png" sizes="32x32" href="{{ 'assets/img/favicon/favicon-32x32.png'|theme }}">
        <link rel="icon" type="image/png" sizes="96x96" href="{{ 'assets/img/favicon/favicon-96x96.png'|theme }}">
        <link rel="icon" type="image/png" sizes="16x16" href="{{ 'assets/img/favicon/favicon-16x16.png'|theme }}">
        <link rel="manifest" href="{{ 'assets/img/favicon/manifest.json'|theme }}">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="{{ 'assets/img/favicon/ms-icon-144x144.png'|theme }}">
        <meta name="theme-color" content="#ffffff">
        <link rel="stylesheet" href="{{ [
            'assets/css/prototype.css',
            '@framework.extras'
        ]|theme }}">
    </head>
    <body>
        <div class="wrapper">
        
            <!-- Header -->
            {% partial 'header' %}

            <!-- Content -->
            <div class="universal-container">
                <section class="universal-section"> 
                    <div class="row bg-lgrey">
                        <div class="col-l-1-of-4 col-m-1-of-3 col-xs-1-of-1 universal-left-column">
                            <aside>
                                <hr>
                                <span>
                                    {{ cvTitle }}
                                </span>
                                <h2>
                                    {{ cvSubTitle }}
                                </h2>
                            </aside>
                        </div>
                        <div class="col-l-3-of-4 col-m-2-of-3 col-xs-1-of-1 bg-white universal-right-column">
                            <article>
                                <section class="apply-form-section">
                                    <div class="row">
                                        <div class="col-xs-1-of-1">
                                            <h3>
                                                {{ record.job_id|length ? 'Apply for this job!'|_ : 'Upload your cv'|_ }}
                                            </h3>
                                            <hr class="{{record.job_id|length ? 'job-green' : 'green'}}">
                                        </div>
                                    </div>
                                    {% component 'form' %}
                                </section>
                            </article>
                            <div id="uploadres"></div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Footer -->
            {% partial 'footer' %}

        </div>

        <!-- Scripts -->
        <script src="{{ [
            'assets/js/app.js',
            '@framework',
            '@framework.extras'
        ]|theme }}"></script>
        
        <script type="text/javascript" src="//platform.linkedin.com/in.js">
            $(window).on('load', function() {
                api_key: 77dug7ogaz4ouh
                onLoad: OnLinkedInFrameworkLoad
                authorize: false
            });
        </script>
        
        <script>
            window.fbAsyncInit = function() {
                FB.init({
                  appId      : '382574281913074',
                  xfbml      : true,
                  version    : 'v2.5'
                });
              };

              (function(d, s, id){
                 var js, fjs = d.getElementsByTagName(s)[0];
                 if (d.getElementById(id)) {return;}
                 js = d.createElement(s); js.id = id;
                 js.src = "//connect.facebook.net/en_US/sdk.js";
                 fjs.parentNode.insertBefore(js, fjs);
               }(document, 'script', 'facebook-jssdk'));

              function myFacebookLogin() {
                FB.init({
                    appId      : '382574281913074',
                    xfbml      : true,
                    version    : 'v2.5'
                });
                FB.login(function(response){
                  if (response.status === 'connected') {
                    console.log('Logged in.');
                    FB.api('/me', {fields: 'name, email, location, gender'}, function(response1){
                        // console.log(response1['name']);
                        $('.apply-form').find('input.name').val(response1['name']);
                        $('.apply-form').find('input.email').val(response1['email']);
                        $('.apply-form').find('input.address').val(response1['location']);
                        $('.apply-form').find('input.gender').val(response1['gender']);
                    });
                    FB.api('/me/picture',{"redirect": false, "height": 200, "width": 200, "type": "normal"}, function(response2){
                        // console.log(response2['data']['url']);
                        $('.apply-form').find('input.photo-url').val(response2['data']['url']);
                        if((response2['data']['url']).length){
                            $('.apply-form').find('#labelP').css('background-image', 'url('+response2['data']['url']+')');
                            $('.photoLabel').text('');
                            $('.apply-form').find('.photo-file').val('');
                        }
                    });
                  }
                  else {
                    FB.login();
                  }
                }, {scope: 'publish_actions'} );
            }

            function liAuth(){
               IN.User.authorize(function(){
                   onLinkedInLoad();
               });
            }

            function OnLinkedInFrameworkLoad() {
              IN.Event.on(IN, "auth", onLinkedInLoad);
            }
            // Setup an event listener to make an API call once auth is complete
            function onLinkedInLoad() {
                IN.API.Profile("me").result(getProfileData);
            }

            // Handle the successful return from the API call
            function onSuccess(data) {
                console.log(data);
                $('.apply-form').find('input.name').val(data['firstName']+' '+data['lastName']);
                $('.apply-form').find('input.email').val(data['emailAddress']);
                $('.apply-form').find('input.address').val(data['location']['name']);
                $('.apply-form').find('input.photo-url').val(data['pictureUrl']);
                if((data['pictureUrl']).length){
                    $('.apply-form').find('#labelP').css('background-image', 'url('+data['pictureUrl']+')');
                    $('.photoLabel').text('');
                    $('.apply-form').find('.photo-file').val('');
                }
            }

            // Handle an error response from the API call
            function onError(error) {
                console.log(error);
            }

            // Use the API call wrapper to request the member's basic profile data
            function getProfileData() {
                IN.API.Raw("/people/~:(first-name,last-name,picture-url,email-address,location)").result(onSuccess);
            }

            var openFile = function(event) {
                var input = event.target;

                var reader = new FileReader();
                reader.onload = function(){
                    var dataURL = reader.result;
                    $('#labelP').css('background-image', 'url('+dataURL+')');
                    $('.photoLabel').text('');
                    $('.apply-form').find('input.photo-url').val('');
                };
                reader.readAsDataURL(input.files[0]);
            };
        </script>
        
        {% component 'googleTracker' %}
        
    </body>
</html>